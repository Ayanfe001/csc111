<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.8, maximum-scale=0.8, user-scalable=no">
    <title>HoRly's Tech Gadgets Quiz</title>
    
    <!-- Tailwind CSS & Config for Dark Mode -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        darkBg: '#0f172a',
                        darkPanel: 'rgba(30, 41, 59, 0.7)',
                    }
                }
            }
        }
    </script>
    
    <!-- html2pdf for PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f8fafc;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Dark Mode Overrides */
        html.dark body { background-color: #0f172a; color: #f1f5f9; }
        html.dark .ambient-bg { background: #0f172a; }
        html.dark .blob-1 { background: radial-gradient(circle, rgba(168,85,247,0.4) 0%, rgba(168,85,247,0) 70%); }
        html.dark .blob-2 { background: radial-gradient(circle, rgba(56,189,248,0.4) 0%, rgba(56,189,248,0) 70%); }
        html.dark .blob-3 { background: radial-gradient(circle, rgba(232,121,249,0.3) 0%, rgba(232,121,249,0) 70%); }
        html.dark .glass-panel { background: rgba(30, 41, 59, 0.6); border-color: rgba(255,255,255,0.1); color: #e2e8f0; }
        html.dark .glass-input { background: rgba(15, 23, 42, 0.5); color: white; border-color: rgba(255,255,255,0.2); }
        html.dark .text-slate-800 { color: #f8fafc; }
        html.dark .text-slate-700 { color: #f1f5f9; }
        html.dark .text-slate-600 { color: #cbd5e1; }
        html.dark .text-slate-500 { color: #94a3b8; }
        html.dark .bg-white\/30 { background-color: rgba(255,255,255,0.05); }
        html.dark .bg-white\/40 { background-color: rgba(255,255,255,0.1); }
        html.dark .bg-white\/50 { background-color: rgba(255,255,255,0.15); }
        html.dark .hover\:bg-white\/60:hover { background-color: rgba(255,255,255,0.2); }

        /* Ambient Animated Background Blobs */
        .ambient-bg {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: -1;
            overflow: hidden;
            background: #f0f4ff;
            transition: background-color 0.3s ease;
        }
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.7;
            animation: float 20s infinite alternate cubic-bezier(0.4, 0, 0.2, 1);
        }
        .blob-1 {
            top: -10%; left: -10%; width: 50vw; height: 50vw;
            background: radial-gradient(circle, rgba(192,132,252,0.8) 0%, rgba(192,132,252,0) 70%);
            animation-duration: 25s;
        }
        .blob-2 {
            bottom: -20%; right: -10%; width: 60vw; height: 60vw;
            background: radial-gradient(circle, rgba(56,189,248,0.8) 0%, rgba(56,189,248,0) 70%);
            animation-duration: 22s;
            animation-delay: -5s;
        }
        .blob-3 {
            top: 30%; left: 40%; width: 45vw; height: 45vw;
            background: radial-gradient(circle, rgba(232,121,249,0.7) 0%, rgba(232,121,249,0) 70%);
            animation-duration: 28s;
            animation-delay: -10s;
        }

        @keyframes float {
            0% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(5%, 10%) scale(1.1); }
            66% { transform: translate(-5%, 5%) scale(0.95); }
            100% { transform: translate(10%, -5%) scale(1.05); }
        }

        /* Liquid Glass Panels */
        .glass-panel {
            background: rgba(255, 255, 255, 0.45);
            backdrop-filter: blur(32px);
            -webkit-backdrop-filter: blur(32px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07), inset 0 0 0 1px rgba(255, 255, 255, 0.3);
            transition: background 0.3s, border-color 0.3s, color 0.3s;
        }
        
        .glass-input {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
            transition: background 0.3s, border-color 0.3s;
        }
        .glass-input:focus {
            background: rgba(255, 255, 255, 0.7);
            border-color: rgba(192, 132, 252, 0.6);
            box-shadow: 0 0 0 4px rgba(192, 132, 252, 0.2), inset 0 2px 4px rgba(0,0,0,0.02);
            outline: none;
        }
        html.dark .glass-input:focus {
            background: rgba(30, 41, 59, 0.9);
            border-color: rgba(192, 132, 252, 0.8);
        }

        .glass-button-primary {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.9), rgba(59, 130, 246, 0.9));
            box-shadow: 0 8px 24px rgba(168, 85, 247, 0.3), inset 0 1px 1px rgba(255,255,255,0.4);
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            color: white;
        }
        .glass-button-primary:hover {
            box-shadow: 0 12px 28px rgba(168, 85, 247, 0.4), inset 0 1px 1px rgba(255,255,255,0.5);
            transform: translateY(-2px);
        }

        /* Scrollbar styles for horizontal nav */
        #nav-grid::-webkit-scrollbar { height: 6px; }
        #nav-grid::-webkit-scrollbar-track { background: transparent; }
        #nav-grid::-webkit-scrollbar-thumb { background: rgba(148, 163, 184, 0.5); border-radius: 10px; }
        #nav-grid::-webkit-scrollbar-thumb:hover { background: rgba(148, 163, 184, 0.8); }

        .hidden { display: none !important; }

        /* Animations */
        @keyframes fadeBlurIn { 
            from { opacity: 0; filter: blur(10px); transform: scale(0.98) translateY(10px); } 
            to { opacity: 1; filter: blur(0); transform: scale(1) translateY(0); } 
        }
        .screen-enter { animation: fadeBlurIn 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        
        @keyframes popIn {
            0% { transform: scale(0.5) translateY(50px); opacity: 0; }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }
        .wa-animate-in { animation: popIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }

        /* Calculator Styles */
        #calculator-modal {
            position: fixed;
            bottom: 80px;
            left: 20px;
            z-index: 100;
            width: 250px;
            cursor: move;
        }
        .calc-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            padding: 10px;
            font-weight: bold;
            transition: all 0.2s;
        }
        .calc-btn:hover { background: rgba(255,255,255,0.4); }
        .calc-btn:active { transform: scale(0.95); }
        html.dark .calc-btn { background: rgba(255,255,255,0.05); color: white; }
        html.dark .calc-btn:hover { background: rgba(255,255,255,0.15); }
    </style>
</head>
<body class="text-slate-800 min-h-screen flex flex-col items-center p-4 sm:p-6 selection:bg-purple-200 selection:text-purple-900">

    <!-- Ambient Background -->
    <div class="ambient-bg">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <!-- Header (Floating Glass Pill) -->
    <div class="glass-panel p-4 sm:p-5 rounded-[2rem] mb-6 sm:mb-10 text-center max-w-2xl w-full mx-auto mt-2 z-10 screen-enter flex justify-between items-center flex-wrap gap-2">
        <div class="text-left">
            <h1 class="text-lg sm:text-2xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-purple-700 to-blue-600 dark:from-purple-400 dark:to-blue-400 tracking-tight">Quiz by HoRly’s_Tech</h1>
            <div class="mt-2 inline-flex items-center justify-center space-x-2 bg-white/40 dark:bg-black/20 backdrop-blur-md px-3 py-1 rounded-full border border-white/50 dark:border-white/10 shadow-sm">
                <svg class="w-3 h-3 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                <p class="text-slate-700 dark:text-slate-300 text-xs font-bold tracking-wide">09121213936</p>
            </div>
        </div>
        
        <!-- Dark Mode Toggle -->
        <button id="theme-toggle" class="p-2 rounded-full bg-white/30 dark:bg-black/30 border border-white/50 dark:border-white/10 shadow-sm hover:scale-105 transition-transform" onclick="toggleDarkMode()">
            <!-- Sun Icon -->
            <svg id="theme-toggle-light-icon" class="w-5 h-5 hidden text-yellow-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
            <!-- Moon Icon -->
            <svg id="theme-toggle-dark-icon" class="w-5 h-5 text-slate-700" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
        </button>
    </div>

    <!-- 0. WELCOME SCREEN -->
    <div id="welcome-screen" class="glass-panel p-8 sm:p-12 rounded-[2.5rem] w-full max-w-lg z-10 screen-enter text-center">
        <div class="flex justify-center mb-8">
            <div class="bg-gradient-to-br from-white/80 to-white/30 dark:from-white/20 dark:to-white/5 p-5 rounded-3xl border border-white/60 dark:border-white/10 shadow-xl backdrop-blur-xl relative group">
                <div class="absolute inset-0 bg-purple-400 rounded-3xl blur-xl opacity-20 group-hover:opacity-40 transition-opacity duration-500"></div>
                <svg class="text-purple-600 dark:text-purple-400 w-16 h-16 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 14l9-5-9-5-9 5 9 5z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"></path></svg>
            </div>
        </div>
        <h2 class="text-3xl font-extrabold text-slate-800 mb-3 tracking-tight">Welcome to HoRly's_tech Quiz</h2>
        <p class="text-slate-600 mb-10 text-lg font-medium leading-relaxed">Test your knowledge with our premium interactive question banks.</p>
        
        <button onclick="handleWelcomeStart()" class="glass-button-primary w-full font-bold py-4 px-6 rounded-2xl flex items-center justify-center transition-all text-lg mb-4">
            Get Started
            <svg class="ml-3 w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
        </button>
        
        <!-- Score History Button -->
        <button onclick="showHistory()" class="w-full text-purple-600 dark:text-purple-400 font-bold py-3 px-6 rounded-2xl bg-white/30 dark:bg-black/30 border border-white/50 dark:border-white/10 hover:bg-white/50 dark:hover:bg-white/10 transition-all flex items-center justify-center">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            View Past Results
        </button>
    </div>

    <!-- 1. LOGIN SCREEN -->
    <div id="login-screen" class="hidden glass-panel p-8 sm:p-10 rounded-[2.5rem] w-full max-w-md z-10 screen-enter">
        <div class="flex justify-center mb-6">
            <div class="bg-white/40 dark:bg-white/10 p-4 rounded-full border border-white/50 dark:border-white/10 shadow-sm">
                <svg class="text-blue-600 dark:text-blue-400 w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
            </div>
        </div>
        <h2 class="text-2xl font-bold text-center mb-2 text-slate-800 tracking-tight">Student Portal</h2>
        <p class="text-slate-500 text-center mb-8 font-medium">Please enter your name to proceed</p>
        <form id="login-form" class="space-y-6">
            <div>
                <input type="text" id="student-name" required class="glass-input w-full px-5 py-4 rounded-2xl text-slate-800 placeholder-slate-400 font-medium transition-all" placeholder="e.g. HoRly's_tech" />
            </div>
            <button type="submit" class="glass-button-primary w-full font-bold py-4 px-4 rounded-2xl flex items-center justify-center transition-all">
                Continue 
                <svg class="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
            </button>
            <button type="button" onclick="switchScreen('welcome')" class="w-full text-slate-500 text-sm font-bold mt-2">Back</button>
        </form>
    </div>

    <!-- 2. COURSE SELECTION SCREEN -->
    <div id="course-screen" class="hidden glass-panel p-6 sm:p-10 rounded-[2.5rem] w-full max-w-lg z-10 screen-enter">
        <h2 class="text-2xl font-bold mb-2 tracking-tight text-slate-800">Welcome, <span id="course-display-name" class="text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-600 dark:from-purple-400 dark:to-blue-400"></span>!</h2>
        <p class="text-slate-500 mb-8 font-medium">Select the course you want to attempt today.</p>
        
        <div class="space-y-4">
            <button onclick="selectCourse('cos')" class="w-full text-left p-5 rounded-2xl border border-white/60 dark:border-white/10 bg-white/30 dark:bg-black/20 hover:bg-white/60 dark:hover:bg-white/10 hover:border-purple-300 dark:hover:border-purple-500 backdrop-blur-md shadow-sm hover:shadow-md transition-all group">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-xl font-bold text-slate-800 group-hover:text-purple-700 dark:group-hover:text-purple-400 transition-colors">COS 101</h3>
                        <p class="text-slate-500 mt-1 text-sm font-medium">Introduction to Computer Science</p>
                    </div>
                    <span class="bg-purple-100/50 dark:bg-purple-900/50 border border-purple-200 dark:border-purple-700 text-purple-800 dark:text-purple-300 text-xs font-bold px-3 py-1.5 rounded-full backdrop-blur-sm">100 Qs Available</span>
                </div>
            </button>

            <button onclick="selectCourse('phy')" class="w-full text-left p-5 rounded-2xl border border-white/60 dark:border-white/10 bg-white/30 dark:bg-black/20 hover:bg-white/60 dark:hover:bg-white/10 hover:border-blue-300 dark:hover:border-blue-500 backdrop-blur-md shadow-sm hover:shadow-md transition-all group">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-xl font-bold text-slate-800 group-hover:text-blue-700 dark:group-hover:text-blue-400 transition-colors">PHY 101</h3>
                        <p class="text-slate-500 mt-1 text-sm font-medium">General Physics I</p>
                    </div>
                    <span class="bg-blue-100/50 dark:bg-blue-900/50 border border-blue-200 dark:border-blue-700 text-blue-800 dark:text-blue-300 text-xs font-bold px-3 py-1.5 rounded-full backdrop-blur-sm">150 Qs Available</span>
                </div>
            </button>
          
            <button onclick="selectCourse('csc')" class="w-full text-left p-5 rounded-2xl border border-white/60 dark:border-white/10 bg-white/30 dark:bg-black/20 hover:bg-white/60 dark:hover:bg-white/10 hover:border-purple-300 dark:hover:border-purple-500 backdrop-blur-md shadow-sm hover:shadow-md transition-all group">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-xl font-bold text-slate-800 group-hover:text-purple-700 dark:group-hover:text-purple-400 transition-colors">CSC 111</h3>
                        <p class="text-slate-500 mt-1 text-sm font-medium">Introduction to Database Concept</p>
                    </div>
                    <span class="bg-purple-100/50 dark:bg-purple-900/50 border border-purple-200 dark:border-purple-700 text-purple-800 dark:text-purple-300 text-xs font-bold px-3 py-1.5 rounded-full backdrop-blur-sm">100 Qs Available</span>
                </div>
            </button>
        </div>
    </div>

    <!-- 3. SETUP SCREEN -->
    <div id="setup-screen" class="hidden glass-panel p-6 sm:p-10 rounded-[2.5rem] w-full max-w-lg z-10 screen-enter">
        <div class="flex items-center justify-between mb-8 pb-4 border-b border-white/40 dark:border-white/10">
            <h2 class="text-2xl font-bold text-slate-800 tracking-tight">Quiz Settings</h2>
            <button onclick="switchScreen('course')" class="text-sm bg-white/40 dark:bg-white/10 hover:bg-white/60 dark:hover:bg-white/20 px-3 py-1.5 rounded-full text-purple-700 dark:text-purple-300 font-bold transition-colors border border-white/50 dark:border-white/10">Change Course</button>
        </div>
        
        <div class="mb-8 text-center">
            <p class="text-xs text-slate-400 font-bold uppercase tracking-widest mb-1">Selected Course</p>
            <p id="setup-course-title" class="text-xl font-extrabold text-slate-800"></p>
        </div>
        
        <div class="space-y-8">
            <div>
                <label class="block text-sm font-bold text-slate-600 mb-4 text-center">Select Number of Questions:</label>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-3" id="question-count-buttons">
                    <!-- Buttons injected via JS -->
                </div>
            </div>

            <div class="bg-blue-50/50 dark:bg-blue-900/30 border border-blue-200/50 dark:border-blue-700/50 backdrop-blur-md rounded-2xl p-5 flex items-start shadow-sm">
                <svg class="text-blue-500 w-6 h-6 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                <div>
                    <p id="setup-time-header" class="text-sm text-blue-900 dark:text-blue-200 font-bold mb-1">Time Limit</p>
                    <p id="time-warning-text" class="text-sm text-blue-700 dark:text-blue-300 font-medium"></p>
                </div>
            </div>

            <button id="start-quiz-btn" class="glass-button-primary w-full font-bold py-4 px-4 rounded-2xl flex items-center justify-center transition-all mt-4 text-lg">
                Begin Assessment
            </button>
        </div>
    </div>

    <!-- 4. QUIZ SCREEN -->
    <div id="quiz-screen" class="hidden w-full max-w-3xl z-10 screen-enter flex flex-col gap-4">
        
        <!-- Main Quiz Area -->
        <div class="flex-1 w-full">
            <!-- Progress Bar -->
            <div class="w-full bg-white/30 dark:bg-black/30 h-2 rounded-full mb-3 overflow-hidden border border-white/50 dark:border-white/10">
                <div id="quiz-progress-bar" class="bg-gradient-to-r from-purple-500 to-blue-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>

            <!-- Horizontal Slidable Question Navigation Grid -->
            <div class="glass-panel p-3 rounded-2xl mb-5 w-full shadow-sm flex flex-col gap-2">
                <div class="flex items-center justify-between px-1">
                    <span class="text-xs font-bold text-slate-500 uppercase tracking-wider">Question Navigator</span>
                    <div class="flex gap-3 text-[10px] sm:text-xs font-bold text-slate-500">
                        <div class="flex items-center"><span class="w-2.5 h-2.5 rounded-full bg-emerald-400 mr-1.5"></span> Ans</div>
                        <div class="flex items-center"><span class="w-2.5 h-2.5 rounded-full bg-rose-400 mr-1.5"></span> Unans</div>
                        <div class="flex items-center"><span class="w-2.5 h-2.5 rounded-full bg-yellow-400 mr-1.5"></span> Flag</div>
                    </div>
                </div>
                <div id="nav-grid" class="flex overflow-x-auto gap-2 py-1 scroll-smooth items-center px-1 snap-x" style="scrollbar-width: thin;">
                    <!-- Grid items injected via JS -->
                </div>
            </div>

            <!-- Floating Status Bar -->
            <div class="glass-panel p-3 sm:p-4 rounded-3xl flex justify-between items-center mb-6 sticky top-4 z-20">
                <div class="flex items-center gap-3">
                    <span id="progress-text" class="bg-white/50 dark:bg-white/10 border border-white/60 dark:border-white/10 text-slate-800 px-4 py-2 rounded-2xl text-sm font-bold shadow-sm backdrop-blur-md"></span>
                    <span id="course-badge" class="px-3 py-1 text-xs font-bold text-purple-700 dark:text-purple-300 bg-purple-100/50 dark:bg-purple-900/50 border border-purple-200 dark:border-purple-700 rounded-full hidden sm:inline-block"></span>
                </div>
                <div id="timer-display" class="flex items-center font-mono font-bold text-lg px-4 py-2 rounded-2xl bg-white/40 dark:bg-white/10 border border-white/50 dark:border-white/10 text-slate-800 shadow-sm backdrop-blur-md transition-colors duration-300">
                    <svg class="w-5 h-5 mr-2 opacity-70" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span id="time-remaining">00:00</span>
                </div>
            </div>

            <!-- Question Card -->
            <div class="glass-panel p-6 sm:p-10 rounded-[2.5rem] mb-6 min-h-[350px]">
                <h2 id="question-text" class="text-xl sm:text-2xl font-bold mb-8 text-slate-800 leading-relaxed tracking-tight"></h2>
                <div id="options-container" class="space-y-3">
                    <!-- Options injected via JS -->
                </div>
            </div>

            <!-- Navigation Controls -->
            <div class="flex flex-wrap justify-between items-center gap-2 sm:gap-4 mb-4">
                <button id="prev-btn" class="flex items-center justify-center px-4 py-3 sm:px-5 sm:py-4 rounded-2xl font-bold transition-all flex-1 sm:flex-none">
                    <svg class="w-5 h-5 mr-1 sm:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> Prev
                </button>

                <!-- Flag for Review Button -->
                <button id="flag-btn" onclick="toggleFlag()" class="flex items-center justify-center px-4 py-3 sm:px-5 sm:py-4 rounded-2xl font-bold transition-all flex-1 sm:flex-none bg-yellow-100/50 dark:bg-yellow-900/30 border border-yellow-300/50 text-yellow-700 dark:text-yellow-400 hover:bg-yellow-200/50">
                    <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"></path></svg> Flag
                </button>

                <button id="next-btn" class="glass-button-primary flex items-center justify-center px-6 py-3 sm:px-8 sm:py-4 rounded-2xl font-bold transition-all flex-1 sm:flex-none">
                    Next <svg class="w-5 h-5 ml-1 sm:ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                </button>
                
                <button id="submit-btn" class="hidden flex items-center justify-center px-6 py-3 sm:px-8 sm:py-4 rounded-2xl font-bold bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-[0_8px_24px_rgba(16,185,129,0.3)] hover:shadow-[0_12px_28px_rgba(16,185,129,0.4)] hover:-translate-y-0.5 border border-white/20 backdrop-blur-md transition-all flex-1 sm:flex-none">
                    Submit <svg class="w-5 h-5 ml-1 sm:ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                </button>
            </div>
        </div>
    </div>

    <!-- 5. RESULTS SCREEN -->
    <div id="results-screen" class="hidden w-full max-w-4xl space-y-6 pb-12 z-10 screen-enter">
        <div class="glass-panel p-8 sm:p-12 rounded-[2.5rem] text-center relative overflow-hidden" id="pdf-content-area">
            <div id="result-bar" class="absolute top-0 left-0 w-full h-2 backdrop-blur-md"></div>
            
            <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-white/40 dark:bg-white/10 border border-white/60 dark:border-white/10 shadow-lg flex items-center justify-center backdrop-blur-md relative">
                <div class="absolute inset-0 rounded-full blur-md opacity-50 mix-blend-multiply" id="result-glow"></div>
                <svg id="award-icon" class="w-12 h-12 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path></svg>
            </div>
            
            <h2 class="text-3xl sm:text-4xl font-extrabold mb-2 text-slate-800 tracking-tight">Assessment Complete, <br class="sm:hidden"/><span id="result-name" class="text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-600 dark:from-purple-400 dark:to-blue-400"></span>!</h2>
            <p id="result-course-text" class="text-slate-500 mb-10 font-medium"></p>
            
            <div class="flex justify-center items-center gap-6 sm:gap-12 mb-10">
                <div class="text-center bg-white/30 dark:bg-white/10 px-6 py-4 rounded-3xl border border-white/50 dark:border-white/10 backdrop-blur-md">
                    <p class="text-4xl sm:text-5xl font-black text-slate-800"><span id="score-correct"></span><span class="text-2xl text-slate-400 font-bold ml-1">/ <span id="score-total"></span></span></p>
                    <p class="text-xs font-bold text-slate-500 mt-2 uppercase tracking-widest">Correct</p>
                </div>
                <div class="text-center bg-white/30 dark:bg-white/10 px-6 py-4 rounded-3xl border border-white/50 dark:border-white/10 backdrop-blur-md">
                    <p id="score-percentage" class="text-4xl sm:text-5xl font-black"></p>
                    <p class="text-xs font-bold text-slate-500 mt-2 uppercase tracking-widest">Score</p>
                </div>
            </div>

            <div id="pass-fail-msg" class="inline-block px-8 py-3 rounded-full font-bold text-lg backdrop-blur-xl shadow-sm mb-6"></div>

            <!-- PROMO BANNER -->
            <div class="mt-6 mx-auto max-w-lg bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-4 text-white shadow-lg border border-white/20 relative overflow-hidden">
                <div class="absolute inset-0 bg-white/10 w-full h-full transform -skew-x-12 translate-x-full group-hover:animate-shimmer"></div>
                <p class="font-extrabold text-lg mb-1">Need a new laptop for school?</p>
                <p class="text-sm font-medium opacity-90">Get 1.0% off at <span class="font-bold underline">HoRly's Tech Gadgets!</span> Show this result to claim.</p>
            </div>
        </div>

        <div class="glass-panel p-6 sm:p-10 rounded-[2.5rem]">
            <div class="flex flex-col sm:flex-row justify-between items-center mb-8 gap-4 border-b border-white/40 dark:border-white/10 pb-6">
                <h3 class="text-2xl font-bold text-slate-800 tracking-tight">Review Answers</h3>
                <div class="flex gap-2 w-full sm:w-auto">
                    <button onclick="downloadPDF()" class="flex-1 sm:flex-none flex items-center justify-center text-white font-bold bg-blue-500 hover:bg-blue-600 px-4 py-2.5 rounded-2xl transition-all shadow-sm">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                        Save PDF
                    </button>
                    <button onclick="location.reload()" class="flex-1 sm:flex-none flex items-center justify-center text-slate-700 dark:text-slate-200 font-bold bg-white/50 dark:bg-white/10 hover:bg-white/70 dark:hover:bg-white/20 px-4 py-2.5 rounded-2xl transition-all border border-white/60 dark:border-white/10 shadow-sm">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> 
                        Restart
                    </button>
                </div>
            </div>
            <div id="review-container" class="space-y-6">
                <!-- Answer review injected via JS -->
            </div>
        </div>
    </div>

    <!-- 6. UNANSWERED WARNING MODAL (Deep Glass) -->
    <div id="warning-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <!-- Deep blur backdrop -->
        <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-md"></div>
        <div class="glass-panel relative rounded-[2.5rem] shadow-2xl max-w-sm w-full p-8 text-center border-white/40 dark:border-white/10 screen-enter">
            <div class="w-16 h-16 bg-rose-100/50 dark:bg-rose-900/50 border border-rose-200 dark:border-rose-700 text-rose-600 dark:text-rose-400 rounded-full flex items-center justify-center mx-auto mb-5 backdrop-blur-sm">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
            </div>
            <h3 class="text-2xl font-bold text-slate-800 mb-2 tracking-tight">Wait a minute!</h3>
            <p class="text-slate-600 mb-8 font-medium">You have <strong id="unanswered-count" class="text-rose-600 dark:text-rose-400 text-lg"></strong> unattempted questions. Are you absolutely sure you want to submit?</p>
            <div class="flex flex-col gap-3">
                <button onclick="closeModal()" class="w-full bg-white/40 dark:bg-white/10 hover:bg-white/60 dark:hover:bg-white/20 border border-white/60 dark:border-white/10 text-slate-800 font-bold py-3.5 px-4 rounded-2xl transition-all backdrop-blur-md">
                    No, take me back
                </button>
                <button onclick="forceSubmit()" class="w-full bg-rose-500/90 hover:bg-rose-600 text-white border border-rose-400 font-bold py-3.5 px-4 rounded-2xl transition-all shadow-[0_4px_14px_rgba(225,29,72,0.3)] backdrop-blur-md">
                    Yes, submit anyway
                </button>
            </div>
        </div>
    </div>

    <!-- 7. HISTORY MODAL -->
    <div id="history-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-md" onclick="closeHistory()"></div>
        <div class="glass-panel relative rounded-[2.5rem] shadow-2xl max-w-lg w-full p-8 text-center border-white/40 dark:border-white/10 screen-enter max-h-[80vh] flex flex-col">
            <h3 class="text-2xl font-bold text-slate-800 mb-4 tracking-tight">Your Past Results</h3>
            <div id="history-container" class="overflow-y-auto flex-1 space-y-3 mb-4 text-left">
                <!-- History injected via JS -->
            </div>
            <button onclick="closeHistory()" class="w-full bg-white/40 dark:bg-white/10 hover:bg-white/60 dark:hover:bg-white/20 border border-white/60 dark:border-white/10 text-slate-800 font-bold py-3 px-4 rounded-2xl transition-all backdrop-blur-md mt-auto">
                Close
            </button>
        </div>
    </div>

    <!-- 8. WHATSAPP FLOATING BUTTON -->
    <a id="wa-button" href="https://chat.whatsapp.com/B9KnUjaH6xN1yIF5HMKLT9?mode=gi_t" target="_blank" class="hidden fixed bottom-6 right-6 sm:bottom-8 sm:right-8 z-[90] bg-white/20 dark:bg-white/10 backdrop-blur-xl border border-white/50 dark:border-white/10 text-emerald-600 dark:text-emerald-400 px-5 py-3 rounded-full shadow-[0_8px_32px_rgba(16,185,129,0.15)] flex items-center gap-3 hover:bg-white/40 dark:hover:bg-white/20 transition-transform transform hover:-translate-y-1 hover:scale-105">
        <div class="bg-emerald-500 text-white p-1.5 rounded-full shadow-inner">
            <svg viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 sm:w-7 sm:h-7"><path d="M12.031 0C5.385 0 0 5.385 0 12.031c0 2.124.553 4.195 1.604 6.014L.045 24l6.105-1.602a11.968 11.968 0 005.881 1.536h.005c6.645 0 12.03-5.385 12.03-12.031 0-3.222-1.255-6.25-3.475-8.471A11.963 11.963 0 0012.031 0zm0 19.957h-.004a9.981 9.981 0 01-5.088-1.385l-.365-.216-3.784.992.992-3.69-.237-.377a9.966 9.966 0 01-1.523-5.25c0-5.502 4.478-9.98 9.98-9.98 2.673 0 5.184 1.042 7.073 2.931 1.889 1.89 2.93 4.4 2.93 7.073 0 5.502-4.478 9.98-9.98 9.98zm5.474-7.485c-.3-.15-1.776-.876-2.052-.977-.276-.1-.477-.15-.678.15s-.777.977-.953 1.177c-.176.2-.352.226-.652.076-.3-.15-1.267-.468-2.414-1.492-.892-.797-1.494-1.78-1.67-2.08-.176-.3-.02-.462.131-.611.135-.135.3-.35.45-.526.15-.175.2-.3.301-.5.1-.2.05-.375-.025-.525-.075-.15-.678-1.635-.928-2.239-.244-.59-.492-.51-.678-.519-.175-.01-.376-.01-.577-.01-.2 0-.526.075-.801.375-.276.3-1.053 1.028-1.053 2.505 0 1.477 1.078 2.903 1.228 3.103.15.2 2.115 3.228 5.123 4.526 2.054.887 2.723.953 3.327.852.684-.113 2.185-.892 2.492-1.753.307-.862.307-1.598.215-1.753-.092-.15-.343-.226-.643-.376z"/></svg>
        </div>
        <div class="flex flex-col text-left">
            <span class="font-extrabold text-sm sm:text-base leading-tight text-slate-800">Join our channel</span>
            <span class="font-bold text-[10px] sm:text-xs text-slate-500 uppercase tracking-wider">for intensive tutorial</span>
        </div>
    </a>

    <!-- 9. CALCULATOR FLOATING BUTTON & MODAL -->
    <button id="calc-trigger-btn" onclick="toggleCalculator()" class="hidden fixed bottom-6 left-6 sm:bottom-8 sm:left-8 z-[90] bg-purple-600 text-white p-4 rounded-full shadow-lg hover:bg-purple-700 transition-transform transform hover:scale-105">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
    </button>
    
    <div id="calculator-modal" class="hidden glass-panel rounded-2xl p-4 shadow-2xl border border-white/50 dark:border-white/10" style="bottom: 90px; left: 24px;">
        <div class="flex justify-between items-center mb-3 cursor-move" id="calc-header">
            <span class="font-bold text-sm text-slate-700 dark:text-slate-300">Calculator</span>
            <button onclick="toggleCalculator()" class="text-slate-500 hover:text-slate-800 dark:hover:text-white">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
        </div>
        <input type="text" id="calc-display" class="w-full bg-white/50 dark:bg-black/40 border border-white/60 dark:border-white/10 rounded-lg p-2 text-right font-mono text-lg mb-3 text-slate-800 dark:text-white focus:outline-none" readonly value="0">
        <div class="grid grid-cols-4 gap-2">
            <button class="calc-btn col-span-2 bg-rose-500/20 text-rose-700 dark:text-rose-400" onclick="calcAction('C')">C</button>
            <button class="calc-btn" onclick="calcAction('DEL')">←</button>
            <button class="calc-btn text-purple-600 dark:text-purple-400" onclick="calcAction('/')">÷</button>
            
            <button class="calc-btn" onclick="calcAction('7')">7</button>
            <button class="calc-btn" onclick="calcAction('8')">8</button>
            <button class="calc-btn" onclick="calcAction('9')">9</button>
            <button class="calc-btn text-purple-600 dark:text-purple-400" onclick="calcAction('*')">×</button>
            
            <button class="calc-btn" onclick="calcAction('4')">4</button>
            <button class="calc-btn" onclick="calcAction('5')">5</button>
            <button class="calc-btn" onclick="calcAction('6')">6</button>
            <button class="calc-btn text-purple-600 dark:text-purple-400" onclick="calcAction('-')">-</button>
            
            <button class="calc-btn" onclick="calcAction('1')">1</button>
            <button class="calc-btn" onclick="calcAction('2')">2</button>
            <button class="calc-btn" onclick="calcAction('3')">3</button>
            <button class="calc-btn text-purple-600 dark:text-purple-400" onclick="calcAction('+')">+</button>
            
            <button class="calc-btn col-span-2" onclick="calcAction('0')">0</button>
            <button class="calc-btn" onclick="calcAction('.')">.</button>
            <button class="calc-btn bg-purple-500/20 text-purple-700 dark:text-purple-400" onclick="calcAction('=')">=</button>
        </div>
    </div>


    <script>
        // --- DATA BANKS ---
        const cosQuestions = [
            { q: "What is a computer?", opts: ["An electronic device that processes data", "A mechanical typewriter", "A power supply unit", "A type of calculator"], ans: 0 },
            { q: "Which of the following is an input device?", opts: ["Printer", "Monitor", "Keyboard", "Speaker"], ans: 2 },
            { q: "The basic operations performed by a computer are:", opts: ["Arithmetic operations", "Logical operations", "Storage and retrieval", "All of the above"], ans: 3 },
            { q: "What does RAM stand for?", opts: ["Read Access Memory", "Random Access Memory", "Read Arithmetic Memory", "Random Arithmetic Memory"], ans: 1 },
            { q: "Which of these is a secondary memory?", opts: ["RAM", "Hard Disk", "CPU", "ROM"], ans: 1 },
            { q: "The full form of CPU is:", opts: ["Central Processing Unit", "Computer Processing Unit", "Central Programming Unit", "Computer Programming Unit"], ans: 0 },
            { q: "Which of these is an Operating System?", opts: ["MS Word", "Chrome", "Windows", "Fortnite"], ans: 2 },
            { q: "The smallest unit of data in a computer is?", opts: ["Byte", "Kilo", "Bit", "Mega"], ans: 2 },
            { q: "Which device is used to convert a digital signal to an analog signal (and vice versa) for communication?", opts: ["Modem", "Monitor", "Printer", "Scanner"], ans: 0 },
            { q: "What is the primary use of an OS (Operating System)?", opts: ["To play games", "To manage computer hardware and software resources", "To browse the internet", "To edit photos"], ans: 1 },
            { q: "Which of these is volatile memory?", opts: ["Hard Disk", "ROM", "RAM", "Flash Drive"], ans: 2 },
            { q: "The work of the ALU (Arithmetic Logic Unit) is:", opts: ["To store data", "To perform mathematical and logical calculations", "To control the flow of data", "To display graphics"], ans: 1 },
            { q: "Which generation of computer used vacuum tubes?", opts: ["First Generation", "Second Generation", "Third Generation", "Fourth Generation"], ans: 0 },
            { q: "What type of software is Microsoft PowerPoint?", opts: ["Database", "Operating System", "Presentation Software", "Spreadsheet"], ans: 2 },
            { q: "Which port is commonly used to connect a modern printer to the computer?", opts: ["VGA", "USB", "HDMI", "PS/2"], ans: 1 },
            { q: "What is a pixel?", opts: ["A type of virus", "The smallest controllable element of a picture represented on the screen", "A programming language", "A sound file"], ans: 1 },
            { q: "Which of these is NOT a web browser?", opts: ["Chrome", "Firefox", "Photoshop", "Edge"], ans: 2 },
            { q: "What does URL stand for?", opts: ["Uniform Resource Locator", "Universal Resource Locator", "Uniform Resource Link", "Unique Resource Link"], ans: 0 },
            { q: "Which of these is an example of malware?", opts: ["Firewall", "Virus", "Antivirus", "Firefox"], ans: 1 },
            { q: "What is a firewall?", opts: ["A wall that protects the computer from fire", "A network security system that monitors and controls incoming and outgoing traffic", "A type of virus", "A web browser"], ans: 1 },
            { q: "Which device is used for Uninterrupted Power Supply?", opts: ["USB", "UPS", "CPU", "GPS"], ans: 1 },
            { q: "What is a high-level programming language?", opts: ["Windows", "Python", "Linux", "Unix"], ans: 1 },
            { q: "The meaning of HTTP is:", opts: ["HyperText Transfer Protocol", "HyperText Transmission Protocol", "High Transfer Text Protocol", "HyperText Type Protocol"], ans: 0 },
            { q: "Which unit is used to measure the processing speed of the CPU?", opts: ["Gigabytes (GB)", "Hertz (Hz/GHz)", "Pixels", "Bits per second"], ans: 1 },
            { q: "What is a computer application?", opts: ["The physical parts of a computer", "Software designed to perform specific tasks for the user", "The operating system", "The internet"], ans: 1 },
            { q: "Which of these is NOT a type of printer?", opts: ["Laserjet", "Plotter", "Monitor", "Inkjet"], ans: 2 },
            { q: "What is the purpose of the monitor?", opts: ["To process data", "To input data", "To display visual output", "To store files"], ans: 2 },
            { q: "Which device is used to generate input graphics or copy documents into the computer?", opts: ["Scanner", "Printer", "Speaker", "Projector"], ans: 0 },
            { q: "What is the full form of PDF?", opts: ["Printed Document Format", "Portable Document Format", "Public Document File", "Personal Data File"], ans: 1 },
            { q: "Which of these refers to a computer network?", opts: ["CPU", "LAN (Local Area Network)", "USB", "PNG"], ans: 1 },
            { q: "What is the purpose of BIOS?", opts: ["To edit videos", "To initialize hardware during booting", "To browse the web", "To scan for viruses"], ans: 1 },
            { q: "Which device is used to point and select items on the screen?", opts: ["Keyboard", "Mouse", "Speaker", "Printer"], ans: 1 },
            { q: "Which of these is NOT a valid file extension?", opts: [".exe", ".doc", ".txt", ".cpu"], ans: 3 },
            { q: "What is the function of the motherboard?", opts: ["To supply power", "To hold and connect the crucial electronic components of the computer", "To display images", "To type text"], ans: 1 },
            { q: "Which is a search engine?", opts: ["Google", "Microsoft Word", "Windows", "Photoshop"], ans: 0 },
            { q: "The purpose of a server is?", opts: ["To type documents", "To provide resources, data, or services to other computers on a network", "To play music", "To cool down the CPU"], ans: 1 },
            { q: "A device that enables online video chat is a?", opts: ["Webcam", "Scanner", "Printer", "Joystick"], ans: 0 },
            { q: "The function of an IP address is?", opts: ["To identify the user's name", "To identify a device on a network", "To measure internet speed", "To protect against viruses"], ans: 1 },
            { q: "The purpose of a compiler is?", opts: ["To write code", "To translate high-level code into machine code", "To execute games", "To browse the internet"], ans: 1 },
            { q: "The function of ROM (Read Only Memory) is?", opts: ["To store temporary data", "To store permanent instructions required to start the computer", "To store user files", "To increase game speed"], ans: 1 },
            { q: "What generation of computer uses an Integrated Circuit (IC)?", opts: ["First", "Second", "Third", "Fourth"], ans: 2 },
            { q: "What is Cloud Computing?", opts: ["Computing during a storm", "Delivering computing services (servers, storage, etc.) over the internet", "Using a wireless mouse", "Printing from a cloud printer"], ans: 1 },
            { q: "Which of these is a type of malware?", opts: ["Trojan", "Anti-virus", "Firewall", "Backup"], ans: 0 },
            { q: "What is the purpose of a device driver?", opts: ["To physically drive the computer", "A program that operates or controls a particular type of device attached to a computer", "To cool the system", "To supply power"], ans: 1 },
            { q: "Which is NOT a type of computer?", opts: ["Supercomputer", "Mainframe", "Microcomputer", "Internet"], ans: 3 },
            { q: "What is a database?", opts: ["A base for data entry", "An organized collection of structured information, or data", "A type of monitor", "A programming language"], ans: 1 },
            { q: "Which is NOT a type of computer memory?", opts: ["RAM", "ROM", "Monitor", "Cache"], ans: 2 },
            { q: "What is the function of an Ethernet card (NIC)?", opts: ["To display graphics", "To connect a computer to a network", "To store files", "To print documents"], ans: 1 },
            { q: "What is the purpose of a PSU (Power Supply Unit)?", opts: ["To store data", "To convert mains AC to low-voltage regulated DC power for the internal components", "To process calculations", "To cool the CPU"], ans: 1 },
            { q: "A device used to control video games is a?", opts: ["Joystick / Gamepad", "Scanner", "Printer", "Microphone"], ans: 0 },
            { q: "A network switch is used to?", opts: ["Turn the internet on and off", "Connect multiple devices on a computer network and route data to the destination", "Scan for viruses", "Print photos"], ans: 1 },
            { q: "What is the purpose of virtual memory?", opts: ["To download more RAM", "To use a section of the hard drive as an extension of RAM", "To play virtual reality games", "To store emails"], ans: 1 },
            { q: "What device is typically used to connect a home network to the Internet Service Provider (ISP)?", opts: ["Monitor", "Modem", "Printer", "Sound Card"], ans: 1 },
            { q: "A sound card is used to?", opts: ["Record video", "Process and deliver audio output", "Connect to the internet", "Save Word documents"], ans: 1 },
            { q: "Which is NOT a type of monitor technology?", opts: ["LED", "CRT", "LCD", "UPS"], ans: 3 },
            { q: "The use of a backup is to?", opts: ["Go back to a previous webpage", "Create a copy of data to recover it in case of data loss", "Speed up the computer", "Hack a system"], ans: 1 },
            { q: "Which is a type of computer file system?", opts: ["NTFS", "HTTP", "HTML", "URL"], ans: 0 },
            { q: "What is the purpose of the taskbar in Windows?", opts: ["To physically hold the monitor", "To locate and launch programs, and view currently open windows", "To clean the screen", "To cool the keyboard"], ans: 1 },
            { q: "What is the purpose of the heat sink?", opts: ["To heat up the computer", "To dissipate heat from the CPU or other components to prevent overheating", "To store hot files", "To burn CDs"], ans: 1 },
            { q: "Which is NOT a type of user interface?", opts: ["GUI (Graphical User Interface)", "CLI (Command Line Interface)", "Apps", "VUI (Voice User Interface)"], ans: 2 },
            { q: "What is the purpose of the Registry in Windows?", opts: ["To register users online", "A central database used to store configuration information and settings", "To write emails", "To clean dust"], ans: 1 },
            { q: "A device used for short-range wireless connection is?", opts: ["Bluetooth", "Ethernet", "Fiber Optic", "Satellite"], ans: 0 },
            { q: "What is the function of the CPU fan?", opts: ["To make noise", "To actively cool the heat sink and CPU", "To spin the hard drive", "To power the monitor"], ans: 1 },
            { q: "Which is NOT a type of computer case form factor?", opts: ["Tower", "Laptop", "Server"], ans: 2 },
            { q: "Which device is NOT a type of Input/Output (I/O) device?", opts: ["Mouse", "Touchscreen", "CPU", "Modem"], ans: 2 },
            { q: "Which is a type of computer battery used on the motherboard?", opts: ["CMOS Battery", "RAM Battery", "AA Battery", "Car Battery"], ans: 0 },
            { q: "A device used for network protection from external threats is?", opts: ["Firewall", "Switch", "Hub", "Repeater"], ans: 0 },
            { q: "The function of a RAID system is to?", opts: ["Kill computer bugs", "Combine multiple disk drive components into a logical unit for redundancy or performance", "Connect to WiFi", "Play videos"], ans: 1 },
            { q: "Which is NOT a type of computer display connection?", opts: ["HDMI", "VGA", "DisplayPort", "RAM"], ans: 3 },
            { q: "The purpose of System Restore is to?", opts: ["Clean the monitor", "Revert the computer's state to a previous point in time", "Delete all files", "Charge the battery"], ans: 1 },
            { q: "Which is NOT a type of physical keyboard mechanism?", opts: ["Mechanical", "Membrane", "Digital (Virtual)", "Scissor-switch"], ans: 2 },
            { q: "What is the purpose of Disk Defragmentation?", opts: ["To delete viruses", "To organize files on the disk to improve access speed", "To break the disk", "To install Windows"], ans: 1 },
            { q: "What is a computer program?", opts: ["A TV show about computers", "A set of instructions that a computer can execute", "A hardware component", "A user manual"], ans: 1 },
            { q: "A program used for software development (coding) is called?", opts: ["IDE (Integrated Development Environment)", "Media Player", "Calculator", "Browser"], ans: 0 },
            { q: "An example of an interpreted language is?", opts: ["C++", "Python", "Assembly", "Machine Code"], ans: 1 },
            { q: "What is Firmware?", opts: ["Soft pillows", "Permanent software programmed into a read-only memory", "A heavy monitor", "An antivirus"], ans: 1 },
            { q: "The purpose of an algorithm is to?", opts: ["Confuse the user", "Provide a step-by-step procedure to solve a problem", "Heat the CPU", "Play music"], ans: 1 },
            { q: "An example of Cloud Storage is?", opts: ["Google Drive / Dropbox", "USB Stick", "CD-ROM", "Floppy Disk"], ans: 0 },
            { q: "Accumulation of dust in the cooling fan causes?", opts: ["Faster processing", "Overheating", "Better graphics", "More storage"], ans: 1 },
            { q: "What is the full form of HTML?", opts: ["HyperText Markup Language", "HighText Machine Language", "HyperText Marking Link", "High Transfer Main Language"], ans: 0 },
            { q: "What is an algorithm?", opts: ["A hardware part", "A specific set of instructions for carrying out a procedure", "A type of monitor", "An input device"], ans: 1 },
            { q: "What is the difference between a compiler and an interpreter?", opts: ["Compiler runs line by line; Interpreter translates the whole code at once", "Compiler translates the whole code at once; Interpreter runs line by line", "Both do the exact same thing", "Compiler is hardware, Interpreter is software"], ans: 1 },
            { q: "What is the main function of the Arithmetic Logic Unit (ALU)?", opts: ["To connect to the internet", "To perform arithmetic and logic operations", "To store the OS", "To boot the computer"], ans: 1 },
            { q: "What is a bus in a computer system?", opts: ["A vehicle for transport", "A communication system that transfers data between components", "A type of power cable", "A cooling fan"], ans: 1 },
            { q: "Which layer of the OSI Model is responsible for logical addressing (IP addresses)?", opts: ["Physical Layer", "Network Layer", "Application Layer", "Session Layer"], ans: 1 },
            { q: "What is the purpose of caching?", opts: ["To delete old files", "To store frequently used data for quicker access", "To slow down the computer", "To encrypt data"], ans: 1 },
            { q: "What is data encapsulation?", opts: ["Deleting data", "The process of adding headers and trailers to data as it moves down the protocol stack", "Breaking the computer", "Compressing files"], ans: 1 },
            { q: "What is the primary difference between Open Source and Proprietary software?", opts: ["Open Source is free; Proprietary is always expensive", "Open Source source code is available to public; Proprietary is closed/owned by a company", "Open Source has viruses; Proprietary does not", "There is no difference"], ans: 1 },
            { q: "What is the standard keyboard shortcut to \"Copy\" selected text?", opts: ["Ctrl + V", "Ctrl + C", "Ctrl + X", "Alt + F4"], ans: 1 },
            { q: "What is the standard keyboard shortcut to \"Paste\" text?", opts: ["Ctrl + P", "Ctrl + V", "Ctrl + C", "Ctrl + Z"], ans: 1 },
            { q: "Which component is often referred to as the \"brain\" of the computer?", opts: ["RAM", "CPU", "Hard Drive", "Motherboard"], ans: 1 },
            { q: "Who is known as the \"Father of the Computer\"?", opts: ["Bill Gates", "Charles Babbage", "Steve Jobs", "Alan Turing"], ans: 1 },
            { q: "What does \"SSD\" stand for in storage technology?", opts: ["Solid State Drive", "Super Speed Disk", "System Storage Device", "Serial State Disk"], ans: 0 },
            { q: "Which of these is a social media platform?", opts: ["LinkedIn", "Excel", "Linux", "Apache"], ans: 0 },
            { q: "What does \"WWW\" stand for in a website address?", opts: ["World Web Wide", "World Wide Web", "World Wide Wares", "Wide World Web"], ans: 1 },
            { q: "Which key is used to refresh the active window in most browsers?", opts: ["F1", "F5", "F10", "Esc"], ans: 1 },
            { q: "1 Kilobyte (KB) is equal to approximately:", opts: ["1000 Bytes (or 1024 Bytes)", "100 Bytes", "1000 Bits", "10 MegaBytes"], ans: 0 },
            { q: "What is \"Phishing\"?", opts: ["A game about fishing", "A cyber attack trying to trick users into revealing sensitive information", "Installing software", "Editing photos"], ans: 1 },
            { q: "Which of the following is an example of a Spreadsheet program?", opts: ["MS Word", "MS Excel", "Notepad", "VLC Player"], ans: 1 },
            { q: "What is the recycle bin used for?", opts: ["To store viruses", "To temporarily store deleted files", "To burn documents", "To keep important files safe"], ans: 1 }
        ];

        const phyQuestions = [
            { q: "The maximum range of a projectile occurs at an angle of:", opts: ["30°", "45°", "60°", "90°"], ans: 1 },
            { q: "A car travelling with a uniform velocity of 30 m s⁻¹ overcomes a frictional force of 600 N. Calculate the power of the engine.", opts: ["6,000 W", "12,000 W", "18,000 W", "30,000 W"], ans: 2 },
            { q: "Name the device that converts heat energy to electrical energy.", opts: ["Transformer", "Generator", "Thermocouple", "Battery"], ans: 2 },
            { q: "The point where the line of best fit cuts the vertical axis is called:", opts: ["Gradient", "Intercept", "Origin", "Axis"], ans: 1 },
            { q: "A body moving at a constant speed accelerates when it is in:", opts: ["Straight-line motion", "Rest", "Circular motion", "Uniform motion"], ans: 2 },
            { q: "A body accelerates uniformly from rest at 2 m s⁻². Find its velocity after travelling 4 m.", opts: ["2 m s⁻¹", "4 m s⁻¹", "6 m s⁻¹", "8 m s⁻¹"], ans: 1 },
            { q: "A force of 100 N acts on a mass of 0.15 kg for 0.03 s. Find the change in speed.", opts: ["10 m s⁻¹", "15 m s⁻¹", "20 m s⁻¹", "25 m s⁻¹"], ans: 2 },
            { q: "An object undergoes oscillatory motion when it moves:", opts: ["In a straight line", "In a circle", "To and fro about a fixed point", "Randomly"], ans: 2 },
            { q: "A body rotates in a circle of radius 2.5 m with angular speed 5 rad s⁻¹. Find the radial acceleration.", opts: ["12.5 m s⁻²", "25 m s⁻²", "50 m s⁻²", "62.5 m s⁻²"], ans: 3 },
            { q: "If A = 5i + 2j + k and B = 2i + 4j − 3k, find A × B.", opts: ["−10i + 17j + 16k", "10i − 17j + 16k", "−16i + 17j − 10k", "16i − 17j + 10k"], ans: 0 },
            { q: "The potential energy in an elastic string is expressed as:", opts: ["kx²", "½kx²", "2kx", "k/x"], ans: 1 },
            { q: "The motion of a simple pendulum is given by a = −100x. Find the period.", opts: ["0.31 s", "0.63 s", "1.26 s", "2.00 s"], ans: 1 },
            { q: "Which of the following is NOT a unit of energy?", opts: ["Joule", "Calorie", "Watt", "Electronvolt"], ans: 2 },
            { q: "Given x = 5t² + 2, find the instantaneous velocity at t = 2 s.", opts: ["10 m s⁻¹", "15 m s⁻¹", "20 m s⁻¹", "25 m s⁻¹"], ans: 2 },
            { q: "The unit cycle per second is called:", opts: ["Newton", "Joule", "Hertz", "Pascal"], ans: 2 },
            { q: "The trajectory of a projectile is:", opts: ["Straight line", "Circle", "Ellipse", "Parabola"], ans: 3 },
            { q: "Which of the following is a fundamental unit?", opts: ["Newton", "Joule", "Candela", "Watt"], ans: 2 },
            { q: "For T = KLˣgʸ, find x and y.", opts: ["x = 1, y = −1", "x = ½, y = −½", "x = −½, y = ½", "x = 2, y = −1"], ans: 1 },
            { q: "From points (20,5) and (10,3) on a velocity–time graph, find acceleration.", opts: ["0.1 m s⁻²", "0.2 m s⁻²", "0.5 m s⁻²", "2.0 m s⁻²"], ans: 1 },
            { q: "A force F = 2i + 4j moves a body through S = i + 5j. Find the work done.", opts: ["18 J", "20 J", "22 J", "24 J"], ans: 2 },
            { q: "Which of the following units is derived?", opts: ["Metre", "Kilogram", "Second", "Newton"], ans: 3 },
            { q: "The slope of a displacement–time graph represents:", opts: ["Acceleration", "Velocity", "Force", "Momentum"], ans: 1 },
            { q: "A body is projected at 20 m s⁻¹ at 60° to the vertical. Find the time of flight.", opts: ["1.00 s", "1.41 s", "1.73 s", "2.00 s"], ans: 2 },
            { q: "Which set of quantities is fundamental?", opts: ["Force, energy, power", "Length, mass and time", "Velocity, acceleration, force", "Pressure, temperature, volume"], ans: 1 },
            { q: "Given T = kmˣlʸgᶻ, find x, y and z.", opts: ["1, −½, ½", "0, ½, −½", "½, 0, −½", "−½, ½, 0"], ans: 1 },
            { q: "A force of 20 N moves a body at constant speed 0.2 m s⁻¹. Find power.", opts: ["2 W", "4 W", "6 W", "10 W"], ans: 1 },
            { q: "A body remains at rest or uniform motion if no net force acts. This is Newton’s:", opts: ["First law", "Second law", "Third law", "Law of gravitation"], ans: 0 },
            { q: "A bullet rises to a height of 500 m. Find initial velocity (g = 10 m s⁻²).", opts: ["50 m s⁻¹", "70 m s⁻¹", "100 m s⁻¹", "120 m s⁻¹"], ans: 2 },
            { q: "A force of 5 N acts for 5 s on a 5 kg mass at rest. Find final momentum.", opts: ["5 kg m s⁻¹", "10 kg m s⁻¹", "20 kg m s⁻¹", "25 kg m s⁻¹"], ans: 3 },
            { q: "Acceleration is equal to the:", opts: ["Area under v–t graph", "Gradient of a velocity–time graph", "Slope of displacement graph", "Momentum divided by time"], ans: 1 },
            { q: "A chemical balance measures:", opts: ["Weight", "Density", "Mass", "Force"], ans: 2 },
            { q: "A car overcomes a friction of 100 N at 30 m s⁻¹. Find power.", opts: ["1000 W", "2000 W", "3000 W", "4000 W"], ans: 2 },
            { q: "The unit of moment of inertia is:", opts: ["kg m", "kg m²", "N m", "J"], ans: 1 },
            { q: "Energy stored in a stretched elastic material is:", opts: ["Chemical energy", "Kinetic energy", "Elastic potential energy", "Heat energy"], ans: 2 },
            { q: "Time to reach maximum height of a projectile is:", opts: ["u/g", "2u/g", "u²/2g", "g/u"], ans: 0 },
            { q: "Correct expression for acceleration is:", opts: ["v = u + at", "a = (v − u)/t", "s = ut", "F = ma"], ans: 0 },
            { q: "A mass of 1000 kg falls from 10 m. Find its kinetic energy before impact (g = 10).", opts: ["10,000 J", "50,000 J", "100,000 J", "200,000 J"], ans: 2 },
            { q: "Force between Earth and Moon is approximately:", opts: ["1.75 × 10¹⁸ N", "1.75 × 10¹⁹ N", "1.75 × 10²⁰ N", "1.75 × 10²¹ N"], ans: 2 },
            { q: "The quantity with same dimension as PV is:", opts: ["Force", "Energy", "Power", "Momentum"], ans: 1 },
            { q: "To determine density of a liquid, what else must be measured?", opts: ["Volume", "Mass", "Temperature", "Pressure"], ans: 1 },
            { q: "Velocity at the highest point of vertical projection is:", opts: ["Maximum", "Zero", "Equal to g", "Constant"], ans: 1 },
            { q: "Materials that regain shape after stress are:", opts: ["Plastic", "Rigid", "Elastic materials", "Brittle"], ans: 2 },
            { q: "If momentum is constant, net force is:", opts: ["Maximum", "Increasing", "Zero", "Variable"], ans: 2 },
            { q: "Which pair is made up of vectors?", opts: ["Speed and mass", "Displacement and acceleration", "Distance and time", "Energy and power"], ans: 1 },
            { q: "The SI unit of power is:", opts: ["Joule", "Newton", "Watt", "Pascal"], ans: 2 },
            { q: "A pendulum makes 50 oscillations in one minute. Find its period.", opts: ["0.8 s", "1.0 s", "1.2 s", "1.5 s"], ans: 2 },
            { q: "A car covers 40 m in 10 s from rest. Find acceleration.", opts: ["0.4 m s⁻²", "0.8 m s⁻²", "1.2 m s⁻²", "2.0 m s⁻²"], ans: 1 },
            { q: "Unit equivalent to watt is:", opts: ["kg m s⁻²", "kg m² s⁻²", "kg m² s⁻³", "kg m s⁻³"], ans: 2 },
            { q: "Given a(t) = −3 + t², find velocity at t = 3 s.", opts: ["6 m s⁻¹", "9 m s⁻¹", "12 m s⁻¹", "15 m s⁻¹"], ans: 1 },
            { q: "The SI unit of force is:", opts: ["Joule", "Watt", "Newton", "Pascal"], ans: 2 },
            { q: "Which quantity has both magnitude and direction?", opts: ["Speed", "Distance", "Velocity", "Mass"], ans: 2 },
            { q: "The rate of change of velocity is called:", opts: ["Force", "Acceleration", "Momentum", "Speed"], ans: 1 },
            { q: "The unit of work is:", opts: ["Newton", "Watt", "Joule", "Pascal"], ans: 2 },
            { q: "A body at rest has kinetic energy equal to:", opts: ["½mv²", "Zero", "mgh", "1 J"], ans: 1 },
            { q: "Which instrument is used to measure atmospheric pressure?", opts: ["Thermometer", "Hydrometer", "Barometer", "Manometer"], ans: 2 },
            { q: "The slope of a displacement–time graph gives:", opts: ["Acceleration", "Force", "Velocity", "Energy"], ans: 2 },
            { q: "The area under a force–distance graph represents:", opts: ["Power", "Momentum", "Work done", "Acceleration"], ans: 2 },
            { q: "The product of mass and velocity is:", opts: ["Force", "Energy", "Momentum", "Impulse"], ans: 2 },
            { q: "The SI unit of momentum is:", opts: ["kg m s⁻²", "kg m s⁻¹", "N s²", "J s"], ans: 1 },
            { q: "A body projected vertically upwards has zero velocity at:", opts: ["Point of projection", "Halfway point", "The highest point", "Just before landing"], ans: 2 },
            { q: "The acceleration due to gravity on Earth is approximately:", opts: ["8.9 m s⁻²", "9.8 m s⁻²", "10.8 m s⁻²", "12 m s⁻²"], ans: 1 },
            { q: "Which of the following is a scalar quantity?", opts: ["Velocity", "Acceleration", "Speed", "Force"], ans: 2 },
            { q: "The resistance of a wire depends on all EXCEPT:", opts: ["Length", "Cross-sectional area", "Material", "Colour"], ans: 3 },
            { q: "The unit of electrical current is:", opts: ["Volt", "Ohm", "Ampere", "Coulomb"], ans: 2 },
            { q: "Which law states that force equals mass times acceleration?", opts: ["Newton’s first law", "Newton’s second law", "Newton’s third law", "Law of gravitation"], ans: 1 },
            { q: "The tendency of a body to resist motion is called:", opts: ["Momentum", "Energy", "Inertia", "Friction"], ans: 2 },
            { q: "Which device converts chemical energy to electrical energy?", opts: ["Generator", "Motor", "Battery", "Transformer"], ans: 2 },
            { q: "The unit of frequency is:", opts: ["Newton", "Hertz", "Joule", "Pascal"], ans: 1 },
            { q: "The distance travelled per unit time is:", opts: ["Velocity", "Acceleration", "Speed", "Momentum"], ans: 2 },
            { q: "A freely falling body moves with:", opts: ["Variable acceleration", "Uniform acceleration", "Zero acceleration", "Constant velocity"], ans: 1 },
            { q: "The force that opposes motion between surfaces in contact is:", opts: ["Tension", "Reaction", "Friction", "Gravity"], ans: 2 },
            { q: "Which quantity is measured in watts?", opts: ["Energy", "Force", "Power", "Pressure"], ans: 2 },
            { q: "The energy stored in a stretched spring is:", opts: ["Heat energy", "Kinetic energy", "Elastic potential energy", "Chemical energy"], ans: 2 },
            { q: "The unit of pressure is:", opts: ["Newton", "Pascal", "Joule", "Watt"], ans: 1 },
            { q: "The graph of velocity against time for uniform motion is:", opts: ["Curve", "Straight line parallel to time axis", "Vertical line", "Parabola"], ans: 1 },
            { q: "The SI unit of mass is:", opts: ["Gram", "Kilogram", "Newton", "Pound"], ans: 1 },
            { q: "A body moving in a circle experiences:", opts: ["Linear acceleration", "Centripetal acceleration", "No acceleration", "Constant velocity"], ans: 1 },
            { q: "The time taken for one complete oscillation is called:", opts: ["Frequency", "Period", "Amplitude", "Phase"], ans: 1 },
            { q: "Which of these is a renewable energy source?", opts: ["Coal", "Petrol", "Solar energy", "Diesel"], ans: 2 },
            { q: "The quantity measured using a stopwatch is:", opts: ["Speed", "Distance", "Time", "Frequency"], ans: 2 },
            { q: "The unit of density is:", opts: ["kg m⁻²", "kg m⁻³", "N m⁻²", "J m⁻³"], ans: 1 },
            { q: "The force of attraction between two masses is:", opts: ["Magnetic force", "Electric force", "Gravitational force", "Frictional force"], ans: 2 },
            { q: "Which mirror always forms a virtual image?", opts: ["Concave", "Convex", "Plane mirror", "Parabolic"], ans: 2 },
            { q: "The SI unit of electric charge is:", opts: ["Volt", "Ampere", "Coulomb", "Ohm"], ans: 2 },
            { q: "Work is done when a force produces:", opts: ["Speed", "Displacement", "Acceleration", "Power"], ans: 1 },
            { q: "The velocity of a body moving with uniform speed in a circle is:", opts: ["Constant", "Zero", "Continuously changing", "Increasing"], ans: 2 },
            { q: "Which quantity is conserved in an isolated system?", opts: ["Force", "Energy only", "Momentum", "Speed"], ans: 2 },
            { q: "The unit of power equivalent to one joule per second is:", opts: ["Newton", "Pascal", "Watt", "Volt"], ans: 2 },
            { q: "Which instrument measures relative density of liquids?", opts: ["Thermometer", "Barometer", "Hydrometer", "Ammeter"], ans: 2 },
            { q: "The motion of a pendulum is:", opts: ["Circular", "Oscillatory", "Random", "Linear"], ans: 1 },
            { q: "The centre of mass of a uniform rod is at its:", opts: ["End", "Quarter length", "Midpoint", "Edge"], ans: 2 },
            { q: "The turning effect of a force is called:", opts: ["Torque", "Moment", "Pressure", "Power"], ans: 1 },
            { q: "The unit of moment is:", opts: ["Joule", "Newton metre", "Pascal", "Watt"], ans: 1 },
            { q: "A body moving with constant speed in a straight line has:", opts: ["Constant acceleration", "Zero acceleration", "Increasing velocity", "Variable force"], ans: 1 },
            { q: "The unit of electric potential difference is:", opts: ["Volt", "Ohm", "Ampere", "Coulomb"], ans: 0 },
            { q: "Which quantity determines the loudness of sound?", opts: ["Frequency", "Wavelength", "Amplitude", "Speed"], ans: 2 },
            { q: "The speed of light in vacuum is approximately:", opts: ["3 × 10⁶ m s⁻¹", "3 × 10⁷ m s⁻¹", "3 × 10⁸ m s⁻¹", "3 × 10⁹ m s⁻¹"], ans: 2 },
            { q: "The product of pressure and volume has the unit of:", opts: ["Force", "Energy", "Power", "Momentum"], ans: 1 },
            { q: "Which law explains floating of objects?", opts: ["Boyle’s law", "Newton’s law", "Archimedes’ principle", "Hooke’s law"], ans: 2 },
            { q: "The energy possessed due to position is:", opts: ["Kinetic energy", "Potential energy", "Heat energy", "Sound energy"], ans: 1 },
            { q: "Which of the following is a derived unit?", opts: ["Metre", "Kilogram", "Newton", "Second"], ans: 2 },
            { q: "The slope of a velocity–time graph gives:", opts: ["Displacement", "Velocity", "Acceleration", "Force"], ans: 2 },
            { q: "Which quantity is measured in joules?", opts: ["Energy", "Power", "Force", "Pressure"], ans: 0 },
            { q: "The resistance of a conductor increases with:", opts: ["Length", "Temperature", "Cross-sectional area", "Volume"], ans: 1 },
            { q: "The unit of angular velocity is:", opts: ["rad s⁻¹", "rad m⁻¹", "rad s", "rad m"], ans: 0 },
            { q: "The force that keeps a body in circular motion acts:", opts: ["Outwards", "Tangent to circle", "Towards the centre", "Vertically"], ans: 2 },
            { q: "The frequency of a wave is measured in:", opts: ["Hertz", "Joule", "Newton", "Watt"], ans: 0 }
        ];

      const cscQuestions = [
        { q: "A DBMS is a collection of ________.", opts: ["Programs only", "Interrelated data only", "Interrelated data and programs", "Files only"], ans: 2 },
        { q: "The primary goal of a DBMS is to provide ________.", opts: ["Fast computers", "Secure hardware", "Convenient and efficient data storage and retrieval", "Cheap storage"], ans: 2 },
        { q: "Information is transformed from data mainly through ________.", opts: ["Hardware", "DBMS", "Compiler", "Operating system"], ans: 1 },
        { q: "The word “data” comes from the word ________.", opts: ["Date", "Database", "Datum", "Detail"], ans: 2 },
        { q: "Data is considered ________.", opts: ["Meaningless", "Interchangeable", "Fixed", "Permanent"], ans: 1 },
        { q: "A database is an ________ collection of data.", opts: ["Random", "Unorganized", "Organized", "Temporary"], ans: 2 },
        { q: "Which of the following is NOT a database?", opts: ["MySQL", "Oracle", "MongoDB", "MS Word"], ans: 3 },
        { q: "File processing systems suffer from ________.", opts: ["Data independence", "Data redundancy", "High security", "Better performance"], ans: 1 },
        { q: "Data redundancy leads to ________.", opts: ["Data integrity", "Data inconsistency", "Data independence", "Data security"], ans: 1 },
        { q: "Difficulty in accessing data is a problem of ________.", opts: ["DBMS", "Database", "File system", "SQL"], ans: 2 },
        { q: "When data is scattered in different files, it is called ________.", opts: ["Data abstraction", "Data isolation", "Data integrity", "Metadata"], ans: 1 },
        { q: "Atomicity problems occur due to ________.", opts: ["User errors", "Incomplete transactions", "Hardware upgrades", "Backup systems"], ans: 1 },
        { q: "Concurrent-access anomalies occur when ________.", opts: ["One user accesses data", "Many users update data simultaneously", "Data is read-only", "Data is encrypted"], ans: 1 },
        { q: "Security is difficult to enforce in ________.", opts: ["DBMS", "Database", "File system", "SQL"], ans: 2 },
        { q: "Integrity constraints are enforced by ________.", opts: ["Users", "Programs", "Hardware", "Compiler"], ans: 1 },
        { q: "Data processed to be useful is called ________.", opts: ["Metadata", "Information", "Knowledge", "Database"], ans: 1 },
        { q: "Data that describes data is called ________.", opts: ["Information", "Metadata", "Schema", "Instance"], ans: 1 },
        { q: "A key is used to ________.", opts: ["Store data", "Encrypt data", "Uniquely identify records", "Delete data"], ans: 2 },
        { q: "A database system consists of ________.", opts: ["Hardware only", "Software only", "Data only", "Hardware, software, people, and data"], ans: 3 },
        { q: "DBMS software helps in ________.", opts: ["Playing media", "Data management", "Web browsing", "File compression"], ans: 1 },
        { q: "The self-describing nature of DBMS uses ________.", opts: ["SQL", "Tables", "Metadata", "Index"], ans: 2 },
        { q: "Program-data independence means ________.", opts: ["Programs depend on data", "Data depends on programs", "Programs and data are independent", "No programs are used"], ans: 2 },
        { q: "Data abstraction hides ________.", opts: ["User interfaces", "Storage details", "Data values", "Programs"], ans: 1 },
        { q: "Multiple views of data allow ________.", opts: ["One user view", "Same data for all users", "Different user perspectives", "No user access"], ans: 2 },
        { q: "Concurrency control ensures ________.", opts: ["Faster computers", "Correct transaction execution", "Data duplication", "More users"], ans: 1 },
        { q: "NTFS is an example of ________.", opts: ["DBMS", "File system", "Database", "Query language"], ans: 1 },
        { q: "SQL is used in ________.", opts: ["File systems", "DBMS", "Operating systems", "Hardware"], ans: 1 },
        { q: "DBMS provides ________ security than file system.", opts: ["Less", "Equal", "More", "No"], ans: 2 },
        { q: "Data consistency in DBMS is ________.", opts: ["Low", "Medium", "High", "Absent"], ans: 2 },
        { q: "Crash recovery is supported by ________.", opts: ["File system", "DBMS", "Compiler", "Editor"], ans: 1 },
        { q: "Airlines use DBMS mainly for ________.", opts: ["Music", "Ticket booking", "Gaming", "Chatting"], ans: 1 },
        { q: "DBMS is used in ________.", opts: ["Banking", "Education", "Healthcare", "All of the above"], ans: 3 },
        { q: "Facebook stores ________.", opts: ["Small data", "No data", "Large databases", "Temporary data"], ans: 2 },
        { q: "Wikipedia is an example of ________.", opts: ["Small database", "Very large database", "File system", "OS"], ans: 1 },
        { q: "E-commerce websites depend heavily on ________.", opts: ["Hardware", "DBMS", "Compiler", "Browser"], ans: 1 },
        { q: "Naive users ________.", opts: ["Write SQL", "Design databases", "Use applications without DBMS knowledge", "Maintain servers"], ans: 2 },
        { q: "Railway ticket users are ________.", opts: ["Sophisticated users", "Naive users", "Database designers", "DBAs"], ans: 1 },
        { q: "System analysts mainly ________.", opts: ["Write code", "Design hardware", "Analyze user requirements", "Backup databases"], ans: 2 },
        { q: "Sophisticated users interact with DBMS using ________.", opts: ["Hardware", "SQL queries", "File systems", "Backup tools"], ans: 1 },
        { q: "Database designers design ________.", opts: ["Queries only", "Tables and relationships", "Hardware", "Operating systems"], ans: 1 },
        { q: "DBA controls ________ levels of database.", opts: ["One", "Two", "Three", "Four"], ans: 2 },
        { q: "DBA provides ________.", opts: ["Security", "Backup", "Recovery", "All of the above"], ans: 3 },
        { q: "DBA account is also called ________.", opts: ["Guest account", "Normal user", "Superuser account", "Temporary account"], ans: 2 },
        { q: "Repairing database damage is the duty of ________.", opts: ["End user", "Programmer", "DBA", "Analyst"], ans: 2 },
        { q: "Creating user accounts is done by ________.", opts: ["Naive users", "DBA", "Designers", "Casual users"], ans: 1 },
        { q: "1-tier architecture has ________.", opts: ["Client only", "Server only", "Client, server, database on same machine", "Separate machines"], ans: 2 },
        { q: "1-tier architecture is mostly used for ________.", opts: ["Large web apps", "Learning purposes", "Banking", "Telecom"], ans: 1 },
        { q: "2-tier architecture follows ________.", opts: ["Peer-to-peer", "Client-server", "Centralized", "Distributed"], ans: 1 },
        { q: "ODBC and JDBC are used in ________.", opts: ["1-tier", "2-tier", "3-tier", "File system"], ans: 1 },
        { q: "3-tier architecture includes ________ layers.", opts: ["Two", "Three", "Four", "Five"], ans: 1 },
        { q: "The middle layer in 3-tier architecture is called ________.", opts: ["Client", "Database", "Application server", "Storage"], ans: 2 },
        { q: "3-tier architecture improves ________.", opts: ["Data loss", "Security", "Redundancy", "Inconsistency"], ans: 1 },
        { q: "Direct client-server interaction is avoided in ________.", opts: ["1-tier", "2-tier", "3-tier", "File system"], ans: 2 }
      ];
      
        const courses = {
            'cos': { name: 'COS 101', title: 'Introduction to Computer Science', questions: cosQuestions },
            'phy': { name: 'PHY 101', title: 'General Physics I', questions: phyQuestions },
            'csc': { name: 'CSC 111', title: 'Introduction to Database Concept', questions: cscQuestions }
        };

        // --- STATE VARIABLES ---
        let userName = "";
        let selectedCourse = null;
        let selectedCount = 30;
        let timeRemaining = 0;
        let timerInterval = null;
        let activeQuestions = [];
        let currentIndex = 0;
        let userAnswers = {};
        let flaggedQuestions = new Set();
        let waVanishTimer = null;
        let calcValue = '0';
        let calcOp = null;
        let calcWait = false;

        // Sound System
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx;

        function initAudio() {
            if (!audioCtx) audioCtx = new AudioContext();
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function playTone(freq, type, duration, vol=0.1) {
            if(!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        function playTick() { playTone(800, 'sine', 0.1, 0.05); }
        function playBuzzer() { playTone(150, 'sawtooth', 0.5, 0.2); }
        function playCheer() {
            [440, 554, 659, 880].forEach((f, i) => setTimeout(() => playTone(f, 'sine', 0.2, 0.1), i*120));
        }

        // --- DOM ELEMENTS ---
        const screens = {
            welcome: document.getElementById('welcome-screen'),
            login: document.getElementById('login-screen'),
            course: document.getElementById('course-screen'),
            setup: document.getElementById('setup-screen'),
            quiz: document.getElementById('quiz-screen'),
            results: document.getElementById('results-screen')
        };
        const warningModal = document.getElementById('warning-modal');
        const waButton = document.getElementById('wa-button');

        // --- LOGIC & FUNCTIONS ---
        function toggleDarkMode() {
            const html = document.documentElement;
            html.classList.toggle('dark');
            const isDark = html.classList.contains('dark');
            document.getElementById('theme-toggle-light-icon').classList.toggle('hidden', !isDark);
            document.getElementById('theme-toggle-dark-icon').classList.toggle('hidden', isDark);
        }

        function switchScreen(screenName) {
            Object.values(screens).forEach(s => {
                s.classList.add('hidden');
                s.classList.remove('screen-enter');
            });
            screens[screenName].classList.remove('hidden');
            void screens[screenName].offsetWidth;
            screens[screenName].classList.add('screen-enter');
            
            // Show calc button only in quiz screen AND only for PHY 101
            if(screenName === 'quiz' && selectedCourse === 'phy') {
                document.getElementById('calc-trigger-btn').classList.remove('hidden');
            } else {
                document.getElementById('calc-trigger-btn').classList.add('hidden');
                document.getElementById('calculator-modal').classList.add('hidden');
            }
        }

        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function formatTime(seconds) {
            const m = Math.floor(seconds / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');
            return `${m}:${s}`;
        }

        function showWhatsApp(temporary = false) {
            waButton.classList.remove('hidden');
            waButton.classList.add('wa-animate-in');
            if (waVanishTimer) clearTimeout(waVanishTimer);
            if (temporary) {
                waVanishTimer = setTimeout(() => hideWhatsApp(), 120000);
            }
        }

        function hideWhatsApp() {
            waButton.classList.add('hidden');
            waButton.classList.remove('wa-animate-in');
            if (waVanishTimer) clearTimeout(waVanishTimer);
        }

        // --- EVENT LISTENERS ---

        function handleWelcomeStart() {
            initAudio();
            switchScreen('login');
            showWhatsApp(true); 
        }

        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const nameInput = document.getElementById('student-name').value.trim();
            if (nameInput) {
                userName = nameInput;
                document.getElementById('course-display-name').textContent = userName;
                switchScreen('course');
            }
        });

        function selectCourse(courseKey) {
            selectedCourse = courseKey;
            selectedCount = 30;
            const courseName = courses[courseKey].name;
            document.getElementById('setup-course-title').textContent = courseName + " - " + courses[courseKey].title;
            document.getElementById('setup-time-header').textContent = `Time Limit (${courseName})`;
            renderCountOptions();
            updateWarningText();
            switchScreen('setup');
        }

        function renderCountOptions() {
            const container = document.getElementById('question-count-buttons');
            container.innerHTML = '';
            
            let options = [30, 50, 100];
            if (selectedCourse === 'phy') options.push(150);

            options.forEach(num => {
                const isSelected = num === selectedCount;
                const btn = document.createElement('button');
                btn.type = 'button';
                
                if (isSelected) {
                    btn.className = "py-4 rounded-2xl border-2 font-bold transition-all border-purple-400 bg-purple-500/10 text-purple-900 dark:text-purple-300 shadow-inner backdrop-blur-md";
                } else {
                    btn.className = "py-4 rounded-2xl border border-white/50 dark:border-white/10 bg-white/30 dark:bg-white/5 text-slate-600 dark:text-slate-300 font-bold hover:bg-white/50 dark:hover:bg-white/10 hover:border-white/70 dark:hover:border-white/20 hover:shadow-sm transition-all backdrop-blur-md";
                }

                btn.textContent = num;
                btn.onclick = () => {
                    selectedCount = num;
                    renderCountOptions();
                    updateWarningText();
                };
                container.appendChild(btn);
            });
        }

        function updateWarningText() {
            const warning = document.getElementById('time-warning-text');
            if (selectedCount === 30) warning.textContent = "You will have exactly 7 minutes to complete 30 questions.";
            if (selectedCount === 50) warning.textContent = "You will have exactly 10 minutes to complete 50 questions.";
            if (selectedCount === 100) warning.textContent = "You will have exactly 20 minutes to complete 100 questions.";
            if (selectedCount === 150) warning.textContent = "You will have exactly 30 minutes to complete 150 questions.";
        }

        document.getElementById('start-quiz-btn').addEventListener('click', () => {
            hideWhatsApp(); 

            let minutes = 7;
            if (selectedCount === 50) minutes = 10;
            if (selectedCount === 100) minutes = 20;
            if (selectedCount === 150) minutes = 30;

            let sourceQuestions = courses[selectedCourse].questions;
            let shuffled = shuffle([...sourceQuestions]);
            activeQuestions = shuffled.slice(0, selectedCount);
            
            currentIndex = 0;
            userAnswers = {};
            flaggedQuestions.clear();
            timeRemaining = minutes * 60;
            
            document.getElementById('course-badge').textContent = courses[selectedCourse].name;
            buildNavGrid();
            renderQuestion();
            updateProgress();
            switchScreen('quiz');

            const timerDisplay = document.getElementById('timer-display');
            const timeText = document.getElementById('time-remaining');
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeRemaining--;
                timeText.textContent = formatTime(timeRemaining);
                
                if (timeRemaining <= 60 && timeRemaining > 0) {
                    timerDisplay.className = "flex items-center font-mono font-bold text-lg px-4 py-2 rounded-2xl bg-rose-500/20 border border-rose-500/40 text-rose-800 dark:text-rose-400 animate-pulse shadow-sm backdrop-blur-md transition-colors duration-300";
                    if(timeRemaining % 2 === 0) playTick(); // Sound effect every 2 seconds in last minute
                } else if (timeRemaining > 60) {
                    timerDisplay.className = "flex items-center font-mono font-bold text-lg px-4 py-2 rounded-2xl bg-white/40 dark:bg-white/10 border border-white/50 dark:border-white/10 text-slate-800 shadow-sm backdrop-blur-md transition-colors duration-300";
                }

                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    forceSubmit();
                }
            }, 1000);
        });

        function buildNavGrid() {
            const grid = document.getElementById('nav-grid');
            grid.innerHTML = '';
            for(let i=0; i<selectedCount; i++) {
                const btn = document.createElement('button');
                btn.id = `nav-btn-${i}`;
                btn.textContent = i + 1;
                btn.className = "w-10 h-10 flex-shrink-0 flex items-center justify-center rounded-xl font-bold text-xs sm:text-sm transition-all border snap-center cursor-pointer";
                btn.onclick = () => {
                    currentIndex = i;
                    renderQuestion();
                };
                grid.appendChild(btn);
            }
            updateGridColors();
        }

        function updateGridColors() {
            for(let i=0; i<selectedCount; i++) {
                const btn = document.getElementById(`nav-btn-${i}`);
                if(!btn) continue;
                
                let baseClass = "w-10 h-10 flex-shrink-0 flex items-center justify-center rounded-xl font-bold text-xs sm:text-sm transition-all border snap-center cursor-pointer ";
                
                if(i === currentIndex) {
                    baseClass += "ring-2 ring-purple-500 scale-110 ";
                    // Smooth scroll active button into view
                    btn.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
                }

                if(flaggedQuestions.has(i)) {
                    baseClass += "bg-yellow-100 dark:bg-yellow-900/50 border-yellow-400 text-yellow-700 dark:text-yellow-400 shadow-[0_0_8px_rgba(234,179,8,0.5)]";
                } else if(userAnswers[i] !== undefined) {
                    baseClass += "bg-emerald-100 dark:bg-emerald-900/50 border-emerald-400 text-emerald-700 dark:text-emerald-400";
                } else {
                    baseClass += "bg-rose-50 dark:bg-rose-900/30 border-rose-200 dark:border-rose-800 text-rose-600 dark:text-rose-400 opacity-70";
                }
                
                btn.className = baseClass;
            }
        }

        function updateProgress() {
            const answeredCount = Object.keys(userAnswers).length;
            const percentage = (answeredCount / selectedCount) * 100;
            document.getElementById('quiz-progress-bar').style.width = `${percentage}%`;
        }

        function toggleFlag() {
            if(flaggedQuestions.has(currentIndex)) {
                flaggedQuestions.delete(currentIndex);
            } else {
                flaggedQuestions.add(currentIndex);
            }
            renderQuestion(); // updates flag button UI
            updateGridColors();
        }

        function renderQuestion() {
            const q = activeQuestions[currentIndex];
            
            document.getElementById('progress-text').textContent = `Q ${currentIndex + 1} / ${selectedCount}`;
            document.getElementById('question-text').textContent = `${currentIndex + 1}. ${q.q}`;
            
            const optsContainer = document.getElementById('options-container');
            optsContainer.innerHTML = '';
            
            q.opts.forEach((opt, idx) => {
                const isSelected = userAnswers[currentIndex] === idx;
                const letter = String.fromCharCode(65 + idx);
                const btn = document.createElement('button');
                
                if (isSelected) {
                    btn.className = "w-full text-left p-5 rounded-2xl border-2 transition-all flex items-center border-purple-400 bg-purple-500/10 shadow-sm backdrop-blur-md";
                } else {
                    btn.className = "w-full text-left p-5 rounded-2xl border transition-all flex items-center border-white/40 dark:border-white/10 bg-white/30 dark:bg-white/5 hover:bg-white/50 dark:hover:bg-white/10 hover:border-white/60 dark:hover:border-white/20 hover:shadow-sm backdrop-blur-md";
                }

                btn.onclick = () => {
                    userAnswers[currentIndex] = idx;
                    updateProgress();
                    updateGridColors();
                    renderQuestion();
                };
                
                const letterBadgeClass = isSelected 
                    ? "bg-gradient-to-br from-purple-500 to-blue-500 text-white shadow-md border-transparent" 
                    : "bg-white/50 dark:bg-white/10 text-slate-600 dark:text-slate-400 border border-white/60 dark:border-white/10";

                btn.innerHTML = `
                    <span class="w-10 h-10 rounded-full flex items-center justify-center font-bold mr-5 flex-shrink-0 ${letterBadgeClass} transition-colors">${letter}</span>
                    <span class="text-base sm:text-lg ${isSelected ? 'text-purple-900 dark:text-purple-300 font-bold' : 'text-slate-700 dark:text-slate-300 font-medium'}">${opt}</span>
                `;
                optsContainer.appendChild(btn);
            });

            // Update Nav Buttons
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-btn');
            const flagBtn = document.getElementById('flag-btn');

            if (currentIndex === 0) {
                prevBtn.disabled = true;
                prevBtn.className = "flex items-center justify-center px-4 py-3 sm:px-5 sm:py-4 rounded-2xl font-bold transition-all flex-1 sm:flex-none bg-white/10 border border-white/20 text-slate-400 cursor-not-allowed backdrop-blur-md";
            } else {
                prevBtn.disabled = false;
                prevBtn.className = "flex items-center justify-center px-4 py-3 sm:px-5 sm:py-4 rounded-2xl font-bold transition-all flex-1 sm:flex-none bg-white/40 dark:bg-white/10 border border-white/50 dark:border-white/20 text-slate-700 dark:text-slate-300 hover:bg-white/60 dark:hover:bg-white/20 hover:shadow-sm backdrop-blur-md";
            }

            if(flaggedQuestions.has(currentIndex)) {
                flagBtn.classList.add('bg-yellow-400', 'text-yellow-900', 'border-yellow-500');
                flagBtn.classList.remove('bg-yellow-100/50', 'text-yellow-700');
            } else {
                flagBtn.classList.remove('bg-yellow-400', 'text-yellow-900', 'border-yellow-500');
                flagBtn.classList.add('bg-yellow-100/50', 'text-yellow-700');
            }

            if (currentIndex === activeQuestions.length - 1) {
                nextBtn.classList.add('hidden');
                submitBtn.classList.remove('hidden');
            } else {
                nextBtn.classList.remove('hidden');
                submitBtn.classList.add('hidden');
            }

            updateGridColors();
        }

        document.getElementById('prev-btn').addEventListener('click', () => {
            if (currentIndex > 0) { currentIndex--; renderQuestion(); }
        });
        document.getElementById('next-btn').addEventListener('click', () => {
            if (currentIndex < activeQuestions.length - 1) { currentIndex++; renderQuestion(); }
        });

        document.getElementById('submit-btn').addEventListener('click', () => {
            const answeredCount = Object.keys(userAnswers).length;
            const unanswered = selectedCount - answeredCount;
            
            if (unanswered > 0) {
                document.getElementById('unanswered-count').textContent = unanswered;
                warningModal.classList.remove('hidden');
            } else {
                forceSubmit();
            }
        });

        function closeModal() {
            warningModal.classList.add('hidden');
        }

        function forceSubmit() {
            clearInterval(timerInterval);
            warningModal.classList.add('hidden');
            document.getElementById('calculator-modal').classList.add('hidden');
            document.getElementById('calc-trigger-btn').classList.add('hidden');
            
            let score = 0;
            activeQuestions.forEach((q, idx) => {
                if (userAnswers[idx] === q.ans) score++;
            });
            
            const percentage = Math.round((score / selectedCount) * 100);
            const passed = percentage >= 50;

            if(passed) playCheer();
            else playBuzzer();

            // Save to LocalStorage
            const history = JSON.parse(localStorage.getItem('horlyTechHistory') || '[]');
            history.push({
                date: new Date().toLocaleDateString(),
                name: userName,
                course: courses[selectedCourse].name,
                score: score,
                total: selectedCount,
                passed: passed
            });
            localStorage.setItem('horlyTechHistory', JSON.stringify(history));

            document.getElementById('result-name').textContent = userName;
            document.getElementById('result-course-text').textContent = courses[selectedCourse].name + " Assessment";
            document.getElementById('score-correct').textContent = score;
            document.getElementById('score-total').textContent = selectedCount;
            
            const percEl = document.getElementById('score-percentage');
            percEl.textContent = `${percentage}%`;
            percEl.className = `text-4xl sm:text-5xl font-black ${passed ? 'text-emerald-600' : 'text-rose-600'}`;
            
            const barEl = document.getElementById('result-bar');
            barEl.className = `absolute top-0 left-0 w-full h-2 backdrop-blur-md ${passed ? 'bg-emerald-500/80' : 'bg-rose-500/80'}`;

            const iconEl = document.getElementById('award-icon');
            iconEl.className = `w-12 h-12 relative z-10 ${passed ? 'text-emerald-500' : 'text-rose-500'}`;
            
            const glowEl = document.getElementById('result-glow');
            glowEl.className = `absolute inset-0 rounded-full blur-md opacity-50 mix-blend-multiply ${passed ? 'bg-emerald-300' : 'bg-rose-300'}`;

            const msgEl = document.getElementById('pass-fail-msg');
            msgEl.textContent = passed 
                ? 'Exceptional Work! You Passed. Brilliant! You deserve a new gadget.' 
                : 'Keep studying! You failed this time. Don\'t give up! Join our tutorial group to ace it next time.';
            msgEl.className = `inline-block px-8 py-3 rounded-full font-bold text-sm sm:text-lg backdrop-blur-xl shadow-sm border ${passed ? 'bg-emerald-500/10 text-emerald-700 dark:text-emerald-400 border-emerald-400/50' : 'bg-rose-500/10 text-rose-700 dark:text-rose-400 border-rose-400/50'}`;

            const reviewContainer = document.getElementById('review-container');
            reviewContainer.innerHTML = '';
            
            activeQuestions.forEach((q, qIdx) => {
                const userAns = userAnswers[qIdx];
                const isCorrect = userAns === q.ans;
                const isUnanswered = userAns === undefined;

                let optsHtml = '';
                q.opts.forEach((opt, optIdx) => {
                    const isThisCorrectOpt = optIdx === q.ans;
                    const isThisUserOpt = optIdx === userAns;
                    
                    let optClass = "p-3.5 rounded-2xl border backdrop-blur-md ";
                    if (isThisCorrectOpt) optClass += "border-emerald-400 bg-emerald-500/20 text-emerald-900 dark:text-emerald-300 font-bold shadow-sm ";
                    else if (isThisUserOpt && !isCorrect) optClass += "border-rose-400 bg-rose-500/20 text-rose-900 dark:text-rose-300 font-bold ";
                    else optClass += "border-white/30 dark:border-white/10 bg-white/10 dark:bg-white/5 text-slate-500 dark:text-slate-400 font-medium ";

                    optsHtml += `
                        <div class="${optClass}">
                            <span class="mr-2 opacity-70">${String.fromCharCode(65 + optIdx)}.</span> ${opt}
                        </div>
                    `;
                });

                const iconSvg = isCorrect 
                    ? `<div class="w-8 h-8 rounded-full bg-emerald-100 dark:bg-emerald-900 border border-emerald-300 flex items-center justify-center text-emerald-600 dark:text-emerald-400"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"></path></svg></div>`
                    : `<div class="w-8 h-8 rounded-full bg-rose-100 dark:bg-rose-900 border border-rose-300 flex items-center justify-center text-rose-600 dark:text-rose-400"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"></path></svg></div>`;

                const blockClass = `p-5 sm:p-6 rounded-3xl border backdrop-blur-lg shadow-sm ${isCorrect ? 'bg-emerald-500/5 border-emerald-300/50' : 'bg-rose-500/5 border-rose-300/50'}`;

                const blockHtml = `
                    <div class="${blockClass}">
                        <div class="flex items-start">
                            <div class="mt-0.5 mr-4 flex-shrink-0">${iconSvg}</div>
                            <div class="w-full">
                                <p class="font-bold text-slate-800 dark:text-slate-200 mb-5 text-lg leading-snug">${qIdx + 1}. ${q.q}</p>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
                                    ${optsHtml}
                                </div>
                                ${isUnanswered ? `<p class="text-rose-700 dark:text-rose-400 text-sm font-bold mt-4 bg-rose-500/20 border border-rose-400/50 inline-block px-3 py-1.5 rounded-lg backdrop-blur-md">You did not answer this question</p>` : ''}
                            </div>
                        </div>
                    </div>
                `;
                reviewContainer.innerHTML += blockHtml;
            });

            switchScreen('results');
            showWhatsApp(false); 
        }

        // --- HISTORY FUNCTIONALITY ---
        function showHistory() {
            const history = JSON.parse(localStorage.getItem('horlyTechHistory') || '[]');
            const container = document.getElementById('history-container');
            container.innerHTML = '';
            
            if(history.length === 0) {
                container.innerHTML = '<p class="text-slate-500 text-center py-4">No past results found.</p>';
            } else {
                history.reverse().forEach(entry => {
                    const pct = Math.round((entry.score/entry.total)*100);
                    container.innerHTML += `
                        <div class="bg-white/40 dark:bg-black/40 border border-white/50 dark:border-white/10 p-4 rounded-xl flex justify-between items-center shadow-sm">
                            <div>
                                <p class="font-bold text-slate-800 dark:text-white">${entry.course}</p>
                                <p class="text-xs text-slate-500">${entry.date} - ${entry.name}</p>
                            </div>
                            <div class="text-right">
                                <p class="font-black ${entry.passed ? 'text-emerald-500' : 'text-rose-500'}">${pct}%</p>
                                <p class="text-xs font-bold text-slate-500">${entry.score}/${entry.total}</p>
                            </div>
                        </div>
                    `;
                });
            }
            document.getElementById('history-modal').classList.remove('hidden');
        }

        function closeHistory() {
            document.getElementById('history-modal').classList.add('hidden');
        }

        // --- PDF DOWNLOAD ---
        function downloadPDF() {
            const element = document.getElementById('pdf-content-area');
            const opt = {
              margin:       0.5,
              filename:     `${userName.replace(/\s+/g, '_')}_HoRly_Result.pdf`,
              image:        { type: 'jpeg', quality: 0.98 },
              html2canvas:  { scale: 2, useCORS: true, logging: false },
              jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(element).save();
        }

        // --- CALCULATOR FUNCTIONALITY ---
        const calcModal = document.getElementById('calculator-modal');
        const calcDisplay = document.getElementById('calc-display');
        
        function toggleCalculator() {
            calcModal.classList.toggle('hidden');
        }

        function calcAction(val) {
            if(val === 'C') {
                calcValue = '0';
            } else if(val === 'DEL') {
                calcValue = calcValue.length > 1 ? calcValue.slice(0, -1) : '0';
            } else if(val === '=') {
                try {
                    // Safe eval wrapper for basic math
                    calcValue = String(new Function('return ' + calcValue)());
                } catch(e) {
                    calcValue = 'Error';
                }
            } else {
                if(calcValue === '0' && val !== '.') calcValue = val;
                else calcValue += val;
            }
            calcDisplay.value = calcValue;
        }

        // Dragging logic for Calculator
        let isDragging = false, startX, startY, startLeft, startBottom;
        document.getElementById('calc-header').addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            startLeft = parseInt(window.getComputedStyle(calcModal).left, 10);
            startBottom = parseInt(window.getComputedStyle(calcModal).bottom, 10);
        });
        document.addEventListener('mousemove', (e) => {
            if(!isDragging) return;
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            calcModal.style.left = `${startLeft + dx}px`;
            calcModal.style.bottom = `${startBottom - dy}px`;
        });
        document.addEventListener('mouseup', () => isDragging = false);

        // Touch support for dragging calc
        document.getElementById('calc-header').addEventListener('touchstart', (e) => {
            isDragging = true;
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
            startLeft = parseInt(window.getComputedStyle(calcModal).left, 10);
            startBottom = parseInt(window.getComputedStyle(calcModal).bottom, 10);
        });
        document.addEventListener('touchmove', (e) => {
            if(!isDragging) return;
            const dx = e.touches[0].clientX - startX;
            const dy = e.touches[0].clientY - startY;
            calcModal.style.left = `${startLeft + dx}px`;
            calcModal.style.bottom = `${startBottom - dy}px`;
        });
        document.addEventListener('touchend', () => isDragging = false);

    </script>
</body>
</html>


